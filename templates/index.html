<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipkart Product Recommendation System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section-title {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        select, input, button {
            padding: 12px 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        select, input {
            flex: 1;
            min-width: 200px;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .product-card {
            background: white;
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .product-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .product-category {
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .product-price {
            color: #2ecc71;
            font-size: 1.3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .product-rating {
            color: #f39c12;
            font-size: 0.9em;
        }
        
        .product-discount {
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            font-size: 0.85em;
            margin-top: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }
        
        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .method-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .method-btn {
            flex: 1;
            padding: 10px;
            background: #f5f5f5;
            border: 2px solid #ddd;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .method-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõí Flipkart Product Recommendations</h1>
            <p class="subtitle">AI-Powered Product Discovery System</p>
        </header>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalProducts">-</div>
                <div class="stat-label">Products</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalUsers">-</div>
                <div class="stat-label">Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalInteractions">-</div>
                <div class="stat-label">Interactions</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgRating">-</div>
                <div class="stat-label">Avg Rating</div>
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">üë§ Personalized Recommendations</h2>
            
            <div class="method-selector">
                <div class="method-btn active" onclick="selectMethod('hybrid')">
                    Hybrid (Best)
                </div>
                <div class="method-btn" onclick="selectMethod('collaborative')">
                    Collaborative Filtering
                </div>
                <div class="method-btn" onclick="selectMethod('popular')">
                    Popular Products
                </div>
            </div>
            
            <div class="controls">
                <select id="userSelect">
                    <option value="">Select a user...</option>
                </select>
                <button onclick="getUserRecommendations()">Get Recommendations</button>
            </div>
            
            <div id="userRecommendations"></div>
        </div>
        
        <div class="section">
            <h2 class="section-title">üîç Similar Products</h2>
            <div class="controls">
                <select id="productSelect">
                    <option value="">Select a product...</option>
                </select>
                <button onclick="getSimilarProducts()">Find Similar</button>
            </div>
            
            <div id="similarProducts"></div>
        </div>
        
        <div class="section">
            <h2 class="section-title">üìÇ Category Recommendations</h2>
            <div class="controls">
                <select id="categorySelect">
                    <option value="">Select a category...</option>
                </select>
                <button onclick="getCategoryRecommendations()">Show Products</button>
            </div>
            
            <div id="categoryProducts"></div>
        </div>
    </div>
    
    <script>
        let currentMethod = 'hybrid';
        
        function selectMethod(method) {
            currentMethod = method;
            document.querySelectorAll('.method-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                document.getElementById('totalProducts').textContent = data.total_products;
                document.getElementById('totalUsers').textContent = data.total_users;
                document.getElementById('totalInteractions').textContent = data.total_interactions;
                document.getElementById('avgRating').textContent = data.avg_rating + '‚≠ê';
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }
        
        async function loadUsers() {
            try {
                const response = await fetch('/api/users');
                const data = await response.json();
                
                const select = document.getElementById('userSelect');
                data.users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.user_id;
                    option.textContent = `${user.user_id} (${user.location}, ${user.age}y)`;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }
        
        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                const data = await response.json();
                
                const select = document.getElementById('productSelect');
                data.products.forEach(product => {
                    const option = document.createElement('option');
                    option.value = product.product_id;
                    option.textContent = product.product_name;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Error loading products:', error);
            }
        }
        
        async function loadCategories() {
            try {
                const response = await fetch('/api/categories');
                const data = await response.json();
                
                const select = document.getElementById('categorySelect');
                data.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }
        
        function displayProducts(products, containerId) {
            const container = document.getElementById(containerId);
            
            if (products.length === 0) {
                container.innerHTML = '<p class="loading">No products found</p>';
                return;
            }
            
            container.innerHTML = '<div class="products-grid">' +
                products.map(product => `
                    <div class="product-card">
                        <div class="product-category">${product.category}</div>
                        <div class="product-name">${product.product_name}</div>
                        <div class="product-price">‚Çπ${product.price.toLocaleString()}</div>
                        <div class="product-rating">‚≠ê ${product.rating} (${product.num_reviews} reviews)</div>
                        ${product.discount > 0 ? `<div class="product-discount">${product.discount}% OFF</div>` : ''}
                    </div>
                `).join('') +
            '</div>';
        }
        
        async function getUserRecommendations() {
            const userId = document.getElementById('userSelect').value;
            if (!userId) {
                alert('Please select a user');
                return;
            }
            
            const container = document.getElementById('userRecommendations');
            container.innerHTML = '<p class="loading">Loading recommendations...</p>';
            
            try {
                const response = await fetch(`/api/recommend/user/${userId}?method=${currentMethod}&n=8`);
                const data = await response.json();
                
                displayProducts(data.recommendations, 'userRecommendations');
            } catch (error) {
                container.innerHTML = '<p class="error">Error loading recommendations</p>';
            }
        }
        
        async function getSimilarProducts() {
            const productId = document.getElementById('productSelect').value;
            if (!productId) {
                alert('Please select a product');
                return;
            }
            
            const container = document.getElementById('similarProducts');
            container.innerHTML = '<p class="loading">Finding similar products...</p>';
            
            try {
                const response = await fetch(`/api/recommend/product/${productId}?n=8`);
                const data = await response.json();
                
                displayProducts(data.similar_products, 'similarProducts');
            } catch (error) {
                container.innerHTML = '<p class="error">Error loading similar products</p>';
            }
        }
        
        async function getCategoryRecommendations() {
            const category = document.getElementById('categorySelect').value;
            if (!category) {
                alert('Please select a category');
                return;
            }
            
            const container = document.getElementById('categoryProducts');
            container.innerHTML = '<p class="loading">Loading products...</p>';
            
            try {
                const response = await fetch(`/api/recommend/category/${category}?n=8`);
                const data = await response.json();
                
                displayProducts(data.recommendations, 'categoryProducts');
            } catch (error) {
                container.innerHTML = '<p class="error">Error loading products</p>';
            }
        }
        
        // Initialize
        window.onload = () => {
            loadStats();
            loadUsers();
            loadProducts();
            loadCategories();
        };
    </script>
</body>
</html>